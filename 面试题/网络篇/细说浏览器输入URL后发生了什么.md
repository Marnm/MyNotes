---
title: 细说浏览器输入URL后发生了什么
tags: []
---

# 细说浏览器输入URL后发生了什么

本文摘要：  
1.DNS域名解析；  
2.建立TCP连接；  
3.发送HTTP请求；  
4.服务器处理请求；  
5.返回响应结果；  
6.关闭TCP连接；  
7.浏览器解析HTML；  
8.浏览器布局渲染；  
总结  

![](http://192.168.85.188:8081/uploads/16529564599602221980220519183400.png)

当我们在浏览器输入网址并回车后，一切从这里开始。

一、DNS域名解析

我们在浏览器输入网址，其实就是要向服务器请求我们想要的页面内容，所有浏览器首先要确认的是域名所对应的服务器在哪里。将域名解析成对应的服务器IP地址这项工作，是由DNS服务器来完成的。

客户端收到你输入的域名地址后，它首先去找本地的hosts文件，检查在该文件中是否有相应的域名、IP对应关系，如果有，则向其IP地址发送请求，如果没有，再去找DNS服务器。一般用户很少去编辑修改hosts文件。

![](http://192.168.85.188:8081/uploads/1652956523138443520220519183507.png)

![](http://192.168.85.188:8081/uploads/165295658576663472820220519183609.png)

浏览器客户端向本地DNS服务器发送一个含有域名www.cnblogs.com的DNS查询报文。本地DNS服务器把查询报文转发到根DNS服务器，根DNS服务器注意到其com后缀，于是向本地DNS服务器返回comDNS服务器的IP地址。本地DNS服务器再次向comDNS服务器发送查询请求，comDNS服务器注意到其www.cnblogs.com后缀并用负责该域名的权威DNS服务器的IP地址作为回应。最后，本地DNS服务器将含有www.cnblogs.com的IP地址的响应报文发送给客户端。

从客户端到本地服务器属于递归查询，而DNS服务器之间的交互属于迭代查询。

正常情况下，本地DNS服务器的缓存中已有comDNS服务器的地址，因此请求根域名服务器这一步不是必需的。
二、建立TCP链接

费了一顿周折终于拿到服务器IP了，下一步自然就是链接到该服务器。对于客户端与服务器的TCP链接，必然要说的就是『三次握手』。

![](http://192.168.85.188:8081/uploads/165295663386943122620220519183703.png)


三次握手

客户端发送一个带有SYN标志的数据包给服务端，服务端收到后，回传一个带有SYN/ACK标志的数据包以示传达确认信息，最后客户端再回传一个带ACK标志的数据包，代表握手结束，连接成功。

上图也可以这么理解：

客户端：“你好，在家不，有你快递。”

服务端：“在的，送来就行。”

客户端：“好嘞。”

三、发送HTTP请求

与服务器建立了连接后，就可以向服务器发起请求了。这里我们先看下请求报文的结构（如下图）：

![](http://192.168.85.188:8081/uploads/1652956672636994845QQ20220519183739.png)

原文：https://segmentfault.com/a/1190000012092552
