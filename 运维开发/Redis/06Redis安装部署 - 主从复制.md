---
title: 06Redis安装部署 - 主从复制
tags: []
---

# Redis主从架构（实现读写分离）

## Redis主从复制过程

主库会基于`pingcheck`方式检查从库是否在线，如果在线则直接同步数据文件至从服务端，从服务端也可以主动发送同步请求到主服务单，主库如果是启动了持久化功能时，会不断的同步数据到磁盘上，主库一旦收到从库的同步请求时，主库会将内存中的数据做快照，然后把数据文件同步给从库，从库得到以后是保存在本地文件中（磁盘），而后把该文加装载到内存中完成数据重建，链式复制也同步如此，因为主是不区分是真正的主，还是另外一个的从。

**1. 启动slave**

**2. slave会向master发送同步命令，请求主库上的数据，不论从服务端是否是第一次连接，master此时都会启动一个后台的子进程将数据快照保存在数据文件中，然后把数据文件发送给slave**

**3. salve收到数据文件以后，会保存到本地，而后把文件重载装入内存**

## 特点

1、 一个Master可以有多个slave；  
2、 支持链式复制（一个slave也可以是其他的slave的slave）；  
3、 Master以非阻塞方式同步数据至slave（master可以同时处理多个slave的读写请求，slave端在同步数据时也可以使用非阻塞方式）


## 启用复制功能

**Slave**

	vim redis.conf
	
```ini
slaveof Redis主服务器IP地址 端口
```

重启redis



## sentinel实现主从架构高可用
